<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
    <meta name="viewport"content="width=device-width,initial-scale=0.5, maximum-scale=0.5, minimum-scale=0.5, user-scalable=no">
	<title>合成图片并保存到本地--最新思路</title>
	<style type="text/css">
	*{
		padding: 0;
		margin: 0;
		border: 0;
		list-style: none;
	}
	button{
		position: fixed;
	    bottom: 100px;
	    left: 150px;
	    display: block;
	    padding: 10px;
	    cursor: pointer;
	}
    .bor{
        border:10px solid red;
    }
    .newI{
        background: url(bg.jpg) no-repeat;
    }
	</style>
    <script src="zepto.js"></script>

</head>
<body>
<div id="draw">
	<canvas id="myCanvas" width="650" height="900" style="border: 1px solid #ccc;"></canvas>
</div>
	<script type="text/javascript">
	$(document).ready(function(){
        var ctx=$('#myCanvas')[0].getContext("2d");
        var bg=new Image();
        bg.src='bg.jpg';
        bg.onload=function(){
        	var bgI=ctx.createPattern(bg,'repeat');
        	ctx.fillStyle=bgI;
        	ctx.fillRect(0,0,$('#myCanvas')[0].width,$('#myCanvas')[0].height)
        };

        var img=new Image();
        img.src='ewm.png';
        img.onload=function(){
            ctx.drawImage(img,180,300,250,250);
        };


        
        $('#draw').bind('touchstart',function(){
            var oImg=new Image();
            oImg.src=$('#myCanvas')[0].toDataURL('image/gif').replace('image/gif','image/octet-stream');
			$(oImg).addClass('newI');
			$('#myCanvas').css('display','none');
			$(oImg).addClass('bor');

            $(oImg).appendTo($('body'));
			window.location=oImg.src;
        })
    });
	</script>
</body>
</html>
